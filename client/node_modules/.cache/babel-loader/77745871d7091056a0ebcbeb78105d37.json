{"ast":null,"code":"import { ADD_PRODUCT, CHANGE_PRODUCT_PENDING_EDIT, EDIT_PRODUCT, REMOVE_PRODUCT, CLEAR_PRODUCT_PENDING_EDIT, SET_PRODUCT_MODIFICATION_STATE, CHANGE_PRODUCT_AMOUNT, LIST_PRODUCT, UPDATE_QR_CODE } from \"../actions/products.action\";\nimport { ProductModificationStatus } from \"../models/product.interface\";\nconst initialState = {\n  modificationState: ProductModificationStatus.None,\n  selectedProduct: null,\n  products: [],\n  searchProductTriggered: false\n};\nfunction productsReducer() {\n  let state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : initialState;\n  let action = arguments.length > 1 ? arguments[1] : undefined;\n  switch (action.type) {\n    case UPDATE_QR_CODE:\n      {\n        const foundIndex = state.products.findIndex(pr => pr._id === action.qrCodeFor);\n        let products = state.products;\n        products[foundIndex] = {\n          ...state.products[foundIndex],\n          ['qr_code']: action.qrCodeFor\n        };\n        return {\n          ...state,\n          products: products\n        };\n      }\n    case LIST_PRODUCT:\n      {\n        const newprod = JSON.parse(JSON.stringify({\n          ...state,\n          products: action.products,\n          searchProductTriggered: true\n        }));\n        return newprod;\n      }\n    case ADD_PRODUCT:\n      {\n        //  let maxId: number = Math.max.apply(Math, state.products.map(function(o) { return o._id; }));\n        //  action.product.id = maxId + 1;\n        return {\n          ...state,\n          products: [...state.products, action.product],\n          searchProductTriggered: true\n        };\n      }\n    case EDIT_PRODUCT:\n      {\n        const foundIndex = state.products.findIndex(pr => pr._id === action.product._id);\n        let products = state.products;\n        products[foundIndex] = action.product;\n        return {\n          ...state,\n          products: products,\n          searchProductTriggered: true\n        };\n      }\n    case REMOVE_PRODUCT:\n      {\n        return {\n          ...state,\n          products: state.products.filter(pr => pr._id !== action.id)\n        };\n      }\n    case CHANGE_PRODUCT_PENDING_EDIT:\n      {\n        return {\n          ...state,\n          selectedProduct: action.product\n        };\n      }\n    case CLEAR_PRODUCT_PENDING_EDIT:\n      {\n        return {\n          ...state,\n          selectedProduct: null\n        };\n      }\n    case SET_PRODUCT_MODIFICATION_STATE:\n      {\n        return {\n          ...state,\n          modificationState: action.value\n        };\n      }\n    case CHANGE_PRODUCT_AMOUNT:\n      {\n        // const foundIndex: number = state.products.findIndex(pr => pr._id === action.id);\n        let products = state.products;\n        return {\n          ...state,\n          products: products\n        };\n      }\n    default:\n      return state;\n  }\n}\nexport default productsReducer;","map":{"version":3,"names":["ADD_PRODUCT","CHANGE_PRODUCT_PENDING_EDIT","EDIT_PRODUCT","REMOVE_PRODUCT","CLEAR_PRODUCT_PENDING_EDIT","SET_PRODUCT_MODIFICATION_STATE","CHANGE_PRODUCT_AMOUNT","LIST_PRODUCT","UPDATE_QR_CODE","ProductModificationStatus","initialState","modificationState","None","selectedProduct","products","searchProductTriggered","productsReducer","state","arguments","length","undefined","action","type","foundIndex","findIndex","pr","_id","qrCodeFor","newprod","JSON","parse","stringify","product","filter","id","value"],"sources":["C:/iDASnew/client/src/store/reducers/products.reducer.ts"],"sourcesContent":["import { IProductState, IActionBase } from \"../models/root.interface\";\r\nimport { ADD_PRODUCT, CHANGE_PRODUCT_PENDING_EDIT, EDIT_PRODUCT, REMOVE_PRODUCT,\r\n    CLEAR_PRODUCT_PENDING_EDIT, SET_PRODUCT_MODIFICATION_STATE, CHANGE_PRODUCT_AMOUNT, LIST_PRODUCT, UPDATE_QR_CODE} from \"../actions/products.action\";\r\nimport { IProduct, ProductModificationStatus } from \"../models/product.interface\";\r\n\r\n\r\n\r\nconst initialState: IProductState = {\r\n    modificationState: ProductModificationStatus.None,\r\n    selectedProduct: null,\r\n    products: [],\r\n    searchProductTriggered : false\r\n};\r\n\r\nfunction productsReducer(state: IProductState = initialState, action: IActionBase): IProductState {\r\n    switch (action.type) {    \r\n        case UPDATE_QR_CODE:{ \r\n            const foundIndex: number = state.products.findIndex(pr => pr._id === action.qrCodeFor);\r\n            let products: IProduct[] = state.products;\r\n            products[foundIndex] = {...state.products[foundIndex], ['qr_code'] : action.qrCodeFor};\r\n            return { ...state, products: products };            \r\n        }  \r\n        case LIST_PRODUCT: {\r\n             const newprod = JSON.parse(JSON.stringify({...state, products:  action.products, searchProductTriggered:true}));      \r\n            return  newprod;\r\n        }        \r\n        case ADD_PRODUCT: {\r\n          //  let maxId: number = Math.max.apply(Math, state.products.map(function(o) { return o._id; }));\r\n          //  action.product.id = maxId + 1;\r\n            return { ...state, products: [...state.products, action.product], searchProductTriggered:true};\r\n        }\r\n        case EDIT_PRODUCT: {\r\n            const foundIndex: number = state.products.findIndex(pr => pr._id === action.product._id);\r\n            let products: IProduct[] = state.products;\r\n            products[foundIndex] = action.product;\r\n            return { ...state, products: products , searchProductTriggered:true};\r\n        }\r\n        case REMOVE_PRODUCT: {\r\n            return { ...state, products: state.products.filter(pr => pr._id !== action.id) };\r\n        }\r\n        case CHANGE_PRODUCT_PENDING_EDIT: {\r\n            return { ...state, selectedProduct: action.product };\r\n        }\r\n        case CLEAR_PRODUCT_PENDING_EDIT: {\r\n            return { ...state, selectedProduct: null };\r\n        }\r\n        case SET_PRODUCT_MODIFICATION_STATE: {\r\n            return { ...state, modificationState: action.value };\r\n        }\r\n        case CHANGE_PRODUCT_AMOUNT: {\r\n           // const foundIndex: number = state.products.findIndex(pr => pr._id === action.id);\r\n            let products: IProduct[] = state.products;\r\n            return { ...state, products: products };\r\n        }\r\n        default:\r\n            return state;\r\n    }\r\n}\r\n\r\n\r\nexport default productsReducer;"],"mappings":"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"},"metadata":{},"sourceType":"module"}